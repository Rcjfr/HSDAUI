<div class="panel-body" [formGroup]="formGroup">

  <!-- New Repair/Existing Repair Radio --> 
  <div class="row">
    <div class="col-sm-6">
      <div class="row form-group">
        <label class="col-sm-4 control-label">Repair:<span class="req">*</span></label>
        <div class="col-sm-8">
          <aac-radio-container label="New Repair">
            <input type="radio" [value]="false" tabindex="88" formControlName="isExistingRepair" />
          </aac-radio-container>
          <aac-radio-container label="Existing Repair">
            <input type="radio" [value]="true" tabindex="88" formControlName="isExistingRepair" />
          </aac-radio-container>
          <div *ngIf="displayMessage.isExistingRepair" class="error">{{displayMessage.isExistingRepair}}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ship Time --> 
  <div class="row">
    <div class="col-sm-8">
      <aac-field-container [required]="true" labelGridColumnWidth="3" fieldGridColumnWidth="8" label="Total Ship Time:" [message]="displayMessage.totalShipTime">
        <input type="text" tabindex='89' class="form-control" [textMask]="{mask: decimalNumberMask}" formControlName="totalShipTime">
      </aac-field-container>
    </div>
  </div>
  
  <!-- Cycles --> 
  <div class="row">
    <div class="col-sm-8">
      <aac-field-container [required]="true" labelGridColumnWidth="3" fieldGridColumnWidth="8" label="Cycles:" [message]="displayMessage.cycles">
        <input type="text" tabindex='90' class="form-control" [textMask]="{mask: numberMask}" formControlName="cycles">
      </aac-field-container>
    </div>
  </div>

  <!-- Repair Inspection Status --> 
  <div class="row form-group">
    <div class="col-sm-8">
      <aac-field-container [required]="true" labelGridColumnWidth="3" fieldGridColumnWidth="8" label="Repair Insp. Status:" [message]="displayMessage.repairInspectionStatus">
        <select class="form-control" tabindex='91' formControlName="repairInspectionStatus">
          <option value="">Select Repair Inspection Status</option>
          <option *ngFor="let ac of repairInspectionStatus$ | async" [value]="ac.id">{{ac.description}}</option>
        </select>
      </aac-field-container>
    </div>
  </div>

 <!-- Critical Fatigue --> 
  <div class="row">
    <div class="col-sm-6">
      <div class="row form-group">
        <label class="col-sm-4 control-label">Fatigue Critical<span class="req">*</span></label>
        <div class="col-sm-8">
          <aac-radio-container label="Yes">
            <input type="radio" [value]="true" tabindex="92" formControlName="isFatigueCritical" />
          </aac-radio-container>
          <aac-radio-container label="No">
            <input type="radio" [value]="false" tabindex="92" formControlName="isFatigueCritical" />
          </aac-radio-container>
          <div *ngIf="displayMessage.isFatigueCritical" class="error">{{displayMessage.isFatigueCritical}}</div>
        </div>
      </div>
    </div>
  </div>
 
  <!-- Stage Dates --> 
  <div class="row">
   
    <div class="col-sm-4">
      <aac-field-container [required]="true" label="Stage 1/RTS Date:" [attr.for]="stage1RTSDate.idDatePicker" [message]="displayMessage.stage1RTSDate">
        <datetime [timepicker]="false" [tabindex]='93' [readonly]="formGroup.get('stage1RTSDate').disabled?true:null" #stage1RTSDate formControlName="stage1RTSDate" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Stage 2 Approval Date:" [attr.for]="stage2Date.idDatePicker">
        <datetime [timepicker]="false" [tabindex]="95" [readonly]="formGroup.get('stage2Date').disabled?true:null" #stage2Date formControlName="stage2Date" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>  

    <div class="col-sm-4">
      <aac-field-container label="Stage 3 Approval Date:" [attr.for]="stage3Date.idDatePicker">
        <datetime [timepicker]="false" [tabindex]="96" [readonly]="formGroup.get('stage3Date').disabled?true:null" #stage3Date formControlName="stage3Date" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>

  </div> 
  
  <!-- SDR Number --> 
  <div class="row">
    <div class="col-sm-4">
      <aac-field-container label="SR #:" [message]="displayMessage.srNumber">
        <input class="form-control" formControlName="srNumber" tabindex="97">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Dossier #:" [message]="displayMessage.rdasNumber">
        <input class="form-control" formControlName="rdasNumber" tabindex="98">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="ETD #:" [message]="displayMessage.etdNumber">
        <input class="form-control" formControlName="etdNumber" tabindex="99">
      </aac-field-container>
    </div>

  </div>
  
  <!-- ESM, Task Card, Repair Date --> 
  <div class="row">

    <div class="col-sm-4">
      <aac-field-container label="ESM Sub/Item #:" [message]="displayMessage.esmSubItemNumber">
        <input class="form-control" formControlName="esmSubItemNumber" tabindex="100">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Task Card #:" [message]="displayMessage.taskCardNo">
        <input class="form-control" formControlName="taskCardNo" tabindex="101">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Repair Date:" [attr.for]="repairDate.idDatePicker">
        <datetime [timepicker]="false" [tabindex]="102" [readonly]="formGroup.get('repairDate').disabled?true:null" #repairDate formControlName="repairDate" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>

  </div>

  <!-- QC Comments and Feedback --> 
  <div class="row">

    <div class="col-sm-4">
      <aac-field-container label="Airline Code:" [message]="displayMessage.airlineCode">
        <input class="form-control" formControlName="airlineCode" tabindex="103">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Repair Removed Date:" [attr.for]="removedByDate.idDatePicker">
        <datetime [timepicker]="false" [tabindex]="104" [readonly]="formGroup.get('removedByDate').disabled?true:null" #removedByDate formControlName="removedByDate" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>
    
    <div class="col-sm-4">
      <aac-field-container label="ECO/ESO/MRB #:" [message]="displayMessage.mrbNumber">
        <input class="form-control" formControlName="mrbNumber" tabindex="105">
      </aac-field-container>
    </div>

  </div>
 
  <!-- MRT, Removed By, Status -->
  <div class="row">

    <div class="col-sm-4">
      <aac-field-container label="MRT #:" [message]="displayMessage.mrtNumber">
        <input class="form-control" formControlName="mrtNumber" tabindex="106">
      </aac-field-container>
    </div>

    <div class="col-sm-4">
      <aac-field-container label="Removed By Record #:" [message]="displayMessage.removedByMrt">
        <input class="form-control" formControlName="removedByMrt" tabindex="107">
      </aac-field-container>
    </div>
    
    <div class="col-sm-4">
      <aac-field-container label="Status:">
        <select class="form-control" tabindex='108' formControlName="status">
          <option value="">Select Status</option>
          <option *ngFor="let stat of status$ | async" [value]="stat.id">{{stat.description}}</option>
        </select>
      </aac-field-container>
    </div>
  </div>

  <!-- Zone, Loction, MRO --> 
  <div class="row">

    <div class="col-sm-4">
      <aac-field-container label="Zone:" [message]="displayMessage.zone">
        <input class="form-control" formControlName="zone" tabindex="109">
      </aac-field-container>
    </div>
    <div class="col-sm-4">
      <aac-field-container label="Location of Repair:" [message]="displayMessage.repairLocation">
        <input class="form-control" formControlName="repairLocation" tabindex="110">
      </aac-field-container>
    </div>
    <div class="col-sm-4">
      <aac-field-container label="MRO Documents:" [message]="displayMessage.mroDocuments">
        <input class="form-control" formControlName="mroDocuments" tabindex="111">
      </aac-field-container>
    </div>
  </div>

  <!-- Legacy EA --> 
  <div class="row">
    <div class="col-sm-4">
      <aac-field-container label="Legacy EA:" [message]="displayMessage.legacyEA">
        <input class="form-control" formControlName="legacyEA" tabindex="112">
      </aac-field-container>
    </div>
    <div class="col-sm-4"></div>
    <div class="col-sm-4"></div>
  </div>

  <!-- ATA Codes --> 
  <div class="row">

  <div class="col-sm-4">
    <aa-ata-code [parent]="formGroup" 
      [sda]="sda" [errorMessages]="displayMessage" [ATACodes]="ATACodes$ | async"
      ATACode1Label="ATA Code 1(DTE):" ATACode2Label="ATA Code 2(DTE):"
      [IsRequired]="false"
      sectionname="dteSection">
    </aa-ata-code>
    </div>
  </div>

  <!-- CHILD COMPONENTS..  Component, Threshold, Inspections, Monitors CHILD ..COMPONENTS--> 
  <div class="row">
    <div class="col-sm-12">
      
      <div class="panel-group">
        
        <aa-dte-component [parent]="formGroup" [sda]="sda" [editable]="editable" [errorMessages]="displayMessage">
        </aa-dte-component>
        
        <aa-dte-threshold-items-array formArrayName="thresholdItems" 
                                       [editable]="editable" 
                                       [errorMessages]="displayMessage?.thresholdItems" 
                                       [itemsFormArray]="formGroup.get('thresholdItems')"> 
        </aa-dte-threshold-items-array>        
        
        <aa-dte-inspection-items-array formArrayName="inspectionItems" 
                                       [editable]="editable" 
                                       [errorMessages]="displayMessage?.inspectionItems" 
                                       [itemsFormArray]="formGroup.get('inspectionItems')"> 
        </aa-dte-inspection-items-array> 
        
        <!-- <input type="checkbox" [formControlName]="inspectionItems.index"> -->
        
          <!-- TWD -->
        <div class="row">
     
         <div class="col-sm-12">
          
          <div class="panel panel-default">

          <div class="panel-heading">Time When Due

            <div class="text-danger">
              <p *ngIf="trackLast"><strong>use whichever occurs last</strong></p>
             </div>
   

           <div class="panel-body">

            <div class="row">
     
            <div class="col-sm-3">
              <aac-field-container label="Current FH:" >
               <input class="form-control"  formControlName="currentFH" tabindex='89'>
              </aac-field-container>
             </div>

             <div class="col-sm-3">
              <aac-field-container label="Current FC:">
               <input class="form-control" formControlName="currentFC" tabindex='90' >
              </aac-field-container>
             </div>
            </div>
            
            <div class="row">
            
          <div class="col-sm-3">
             <aac-field-container label="FH remaining:" >
              <input class="form-control"  formControlName="dueHours" tabindex='89'>
             </aac-field-container>
            </div>

            <div class="col-sm-3">
             <aac-field-container label="FC remaining:">
              <input class="form-control" formControlName="dueCycles" tabindex='90' >
             </aac-field-container>
            </div>

            <div class="col-sm-4">
             <aac-field-container label="DTE Due Date:">
              <input class="form-control" formControlName="dueDate" tabindex="163">
             </aac-field-container>
            </div>  

            <div class="col-sm-2">
             <button type="button" class="btn btn-danger btn-xs"  (click)="populateTWD()"> <span class="glyphicon glyphicon-random"></span>  Calculate TWD</button>
            </div>
  
           </div>
 
   
          </div>
 
         </div> 

         </div>
      
        </div>



        <aa-dte-monitor-items-array formArrayName="monitorItems"
                                    [editable]="editable"
                                    [errorMessages]="displayMessage?.monitorItems"
                                    [itemsFormArray]="formGroup.get('monitorItems')">
        </aa-dte-monitor-items-array>
      
      </div>
    
    </div>
  
  </div>

  <!-- QC Comments and Feedback -->  
  <div class="row">
    <div class="col-sm-6">
      <aac-field-container label="DTE Comments:" [message]="displayMessage.comments">
        <textarea class="form-control" tabindex="155" rows="5" cols="50" formControlName="comments"></textarea>
      </aac-field-container>
    </div>
    <div class="col-sm-6">
      <aac-field-container label="QC Feedback:" [message]="displayMessage.qcFeedback">
        <textarea class="form-control" rows="5" cols="50" tabindex="156" formControlName="qcFeedback"></textarea>
      </aac-field-container>
    </div>
  </div>

  <!-- QC Submit --> 
  <div class="row form-group">
    <div class="col-sm-6">
      <aac-checkbox-container label="Submit to QC">
        <input type="checkbox" tabindex="157" formControlName="submitToQC" />
      </aac-checkbox-container>
    </div>
  </div>

  <!-- DTE Status -->   
  <div class="row">
    <div class="col-sm-8">
      <aac-field-container [required]="true" labelGridColumnWidth="3" fieldGridColumnWidth="8" label="DTE Status:" [message]="displayMessage.dteStatus">
        <select class="form-control" tabindex='158' formControlName="dteStatus">
          <option value="">Select DTE Status </option>
          <option *ngFor="let ac of dteStatus$ | async" [value]="ac.id">{{ac.description}}</option>
        </select>
      </aac-field-container>
    </div>
  </div>

  <!-- Attachments --> 
  <div class="row form-group">
    <div class="col-sm-12">
      <h3>Attachments:</h3>
      <table class="table">
        <thead>
          <tr>
            <th width="50%">Name</th>
            <th>Size</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let attachment of getAttachments().controls;let j=index">
            <td>
              <strong>
                <a (click)="downloadAttachment(sda.id, attachment.get('attachmentPath').value, attachment.get('attachmentName').value)" href="{{hsdaApiBaseUrl}}sda/{{sda.id}}/attachments/{{attachment.get('attachmentPath').value}}/{{ attachment.get('attachmentName').value }}" target="_blank">{{ attachment.get('attachmentName').value }}</a>
              </strong>
            </td>
            <td nowrap>{{ attachment.get('attachmentSize').value | byteFmt: 2 }}</td>
            <td nowrap>
              <button type="button" class="btn btn-danger btn-xs"
                      (click)="deleteAttachment(j)" *ngIf="editable">
                <span class="glyphicon glyphicon-trash"></span> Remove
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <div>
        <label class="btn btn-primary btn-file" *ngIf="editable" [tabindex]="159">
          Add Attachment <input type="file" #uploadEl ng2FileSelect [uploader]="uploader" style="display: none;">
        </label>
      </div>

    </div>
  </div>

  <!-- Major Repair Updates -->  
  <div class="row">

    <!-- Major Repair Updated By -->    
    <div class="col-sm-6 padding-left-0">
    
      <aac-field-container class="col-sm-12 padding-0" labelGridColumnWidth="3" fieldGridColumnWidth="9" label="Major Repair Updated By:" [message]="displayMessage.updatedBy">
        <div class="padding-0">
          <div class="col-sm-3 padding-0">
            <input type="text" class="form-control" tabindex="160" formControlName="updatedByEmpID" placeholder="Employee ID">
          </div>
         
          <div class="col-sm-2 padding-0 width-20">_</div>
          
          <div class="col-sm-7 padding-0">
            <input type="text" class="form-control" tabindex="161" placeholder="Last Name, First Name" formControlName="updatedByName">
          </div>
        </div>
      </aac-field-container>
   
    </div>

    <!-- Major Repair Update Date -->
    <div class="col-sm-4 padding-0">
      <aac-field-container label="Major Repair Updated Date:" labelGridColumnWidth="5" fieldGridColumnWidth="7" [attr.for]="updatedDate.idDatePicker" [message]="displayMessage.updatedDate">
        <datetime [timepicker]="false" [readonly]="true" [tabindex]="162" #updatedDate formControlName="updatedDate" [datepicker]="{ icon: 'glyphicon glyphicon-calendar',autoclose:true }"></datetime>
      </aac-field-container>
    </div>
 
  </div>



</div>
