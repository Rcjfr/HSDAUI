<h2>Create new SDA</h2>
<form novalidate (submit)="saveAlert()" [formGroup]="sdaForm">
  <div class="panel panel-default">
    <div class="panel-heading">General Information</div>
    <div class="panel-body">
      <div class="row form-group">
        <div class="col-md-6">
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="sdrNumber">SDR Number:</label>
            <div class="controls col-sm-8">
              <input type="text" class="form-control"
                     tabindex="1" id="sdrNumber" placeholder=""
                     formControlName="sdrNumber">
              <span *ngIf="sdaForm.get('sdrNumber').invalid && (showErrors || (sdaForm.get('sdrNumber').dirty || sdaForm.get('sdrNumber').touched))" class="error">SDR Number must be alphanumeric.</span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <label>
            <aac-checkbox [checkboxState]="lineMaintenance" tabindex="2" (onChangeNotify)="alert.lineMaintenance=lineMaintenance.isChecked"></aac-checkbox>
            Line Maintenance
          </label>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-md-6">
          <div class="row form-group">
            <label class="col-sm-4 control-label" tabindex='3'>Create Date: <span class="req">*</span></label>
            <div class="col-sm-8">
              <datetime [timepicker]="false" id="sdaCreateDate" formControlName="createDate"
                        [datepicker]="{ icon: 'glyphicon glyphicon-calendar' }"></datetime>
              <span *ngIf="sdaForm.get('createDate').invalid && (showErrors || (sdaForm.get('createDate').dirty || sdaForm.get('createDate').touched))" class="error">Create Date is required.</span>
            </div>

          </div>
        </div>
        <div class="col-md-6">
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="sdaAlertCode">Alert Code: <span class="req">*</span></label>
            <div class="col-sm-8">
              <select tabindex='13' class="form-control" id="sdaAlertCode" formControlName="alertCode">
                <option value="">Select Alert Code</option>
                <option value="A">A - Significant Structure Defect</option>
                <option value="B">B - Significant Structure Corrosion</option>
                <option value="C">C - Ground Damage</option>
                <option value="D">Other - Bird Strike,Lightning Strike, etc</option>
              </select>
              <span *ngIf="sdaForm.get('alertCode').invalid && (showErrors || (sdaForm.get('alertCode').dirty || sdaForm.get('alertCode').touched))" class="error">Alert Code is required.</span>
            </div>

          </div>
        </div>
      </div>
      <div class="row  form-group">
        <div class="col-md-6">
            <div class="row form-group">
                <label class="col-sm-4 control-label" for="sdaId">SDA ID:</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="sdaId" readonly placeholder="" formControlName="sdaId">
                </div>

            </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="station">Station: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='4' class="form-control" id="station" maxlength="3" placeholder=""
                     formControlName="station" />
              <span *ngIf="sdaForm.get('station').invalid && (showErrors || (sdaForm.get('station').dirty || sdaForm.get('station').touched))" class="error">
                <span *ngIf="sdaForm.get('station').errors.required">Station is required.</span>
                <span *ngIf="sdaForm.get('station').errors.minlength">Station must be 3 alphabet characters.</span>
              </span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
            <div class="row form-group">
                <label class="col-sm-4 control-label" for="ataCode1">ATA Code 1: <span class="req">*</span></label>
                <div class="col-sm-8">
                    <select class="form-control" tabindex='14' id="ataCode1" (change)='getAlertCode2s($event.target.value)' formControlName="ataCode1">
                        <option value="">Select ATA Code 1</option>
                        <option *ngFor="let ac of ataCodes$ | async" [value]="ac.Code">{{ac.Code}} - {{ac.Name}}</option>
                    </select>
                    <span *ngIf="sdaForm.get('ataCode1').invalid && (showErrors || (sdaForm.get('ataCode1').dirty || sdaForm.get('ataCode1').touched))" class="error">ATA Code 1 is required.</span>
                </div>
            </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="ataCode2">ATA Code 2: <span class="req">*</span></label>
            <div class="col-sm-8">
              <select class="form-control" tabindex='15' id="ataCode2" required formControlName="ataCode2">
                <option value="">Select ATA Code 2</option>
                <option *ngFor="let ac of ataCode2s$ | async" [value]="ac.Code">{{ac.Code}} {{ac.Name}}</option>
              </select>
              <span *ngIf="sdaForm.get('ataCode2').invalid && (showErrors || (sdaForm.get('ataCode2').dirty || sdaForm.get('ataCode2').touched))" class="error">ATA Code 2 is required.</span>
            </div>

          </div>
        </div>
      </div>
      <div class="row  form-group">
        <div class="col-md-6">
          


        </div>
        <div class="col-md-6">
            

        </div>
      </div>
      <div class="row  form-group">
        <div class="col-md-6">
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="department">Department: <span class="req">*</span></label>
            <div class="col-sm-8">
              <select class="form-control" tabindex='5' id="department" formControlName="department">
                <option value="">Select Department</option>
                <option value="engineering">Engineering</option>
                <option value="inspection">Inspection</option>
                <option value="other">Other</option>
              </select>
              <span *ngIf="sdaForm.get('department').invalid && (showErrors || (sdaForm.get('department').dirty || sdaForm.get('department').touched))" class="error">Department is required.</span>
            </div>
          </div>
          <!--Aircraft Info Section-->
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="aircraftNo">Aircraft #: <span class="req">*</span></label>
            <div class="col-sm-8">
              <!--<div class="input-group">
                  <input type="text" #airCraftNo="ngModel" class="form-control" name="airCraftNo" id="airCraftNo" required
                         [(ngModel)]="alert.aircraftNo"
                         [typeahead]="noseNumbers$"
                         (typeaheadOnSelect)="noseNumberOnSelect($event)"
                         (change)="populateAircraftInfo($event.target.value)">

                  <div class="input-group-addon">
                      <span class="glyphicon glyphicon-refresh" [class.glyphicon-refresh-animate]="loading$|async" (click)="populateAircraftInfo(alert.aircraftNo)"></span>
                  </div>
              </div>-->
              <input type="text" class="form-control" tabindex='6' id="aircraftNo"
                     formControlName="aircraftNo" />
              <span *ngIf="sdaForm.get('aircraftNo').invalid && (showErrors || (sdaForm.get('aircraftNo').dirty || sdaForm.get('aircraftNo').touched))" class="error">Aircraft # is required and must be alphanumeric.</span>
            </div>
          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="manufacturer">Aircraft Manufacturer: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='7' class="form-control" id="manufacturer" placeholder=""
                     formControlName="manufacturer">
              <span *ngIf="sdaForm.get('manufacturer').invalid && (showErrors || (sdaForm.get('manufacturer').dirty || sdaForm.get('manufacturer').touched))" class="error">Manufacturer is required and must contain only alphanumerics.</span>
            </div>

          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="model">Aircraft Model/Series: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='8' class="form-control" id="model" placeholder="" formControlName="model">
              <span *ngIf="sdaForm.get('model').invalid && (showErrors || (sdaForm.get('model').dirty || sdaForm.get('model').touched))" class="error">Aircraft Model/Series is required and must contain only alphanumerics.</span>
            </div>

          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="serialNo">Serial #: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='9' class="form-control" id="serialNo" placeholder="" formControlName="serialNo">
              <span *ngIf="sdaForm.get('serialNo').invalid && (showErrors || (sdaForm.get('serialNo').dirty || sdaForm.get('serialNo').touched))" class="error">Serial # is required and must contain only alphanumerics.</span>
            </div>

          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="totalShipTime">Total Ship Time: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='10' class="form-control" id="totalShipTime" placeholder=""
                     formControlName="totalShipTime">
              <span *ngIf="sdaForm.get('totalShipTime').invalid && (showErrors || (sdaForm.get('totalShipTime').dirty || sdaForm.get('totalShipTime').touched))" class="error">Total Ship Time is required and must be numeric.</span>
            </div>

          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="cycles">Cycles: <span class="req">*</span></label>
            <div class="col-sm-8">
              <input type="text" tabindex='11' class="form-control" id="cycles" placeholder="" formControlName="cycles">
              <span *ngIf="sdaForm.get('cycles').invalid && (showErrors || (sdaForm.get('cycles').dirty || sdaForm.get('cycles').touched))" class="error">Cycles is required and must be numeric.</span>
            </div>

          </div>
          <div class="row form-group">
            <label class="col-sm-4 control-label" for="fleet">Fleet: <span class="req">*</span></label>
            <div class="col-sm-8">
              <!--<input type="text" #fleet="ngModel" tabindex='10' class="form-control" name="fleet" id="fleet"
                         required placeholder="" [(ngModel)]="alert.fleet"
                         (change)="populateCheckTypes()">-->
              <input type="text" tabindex='12' class="form-control" id="fleet"
                     placeholder="" formControlName="fleet">
              <span *ngIf="sdaForm.get('fleet').invalid && (showErrors || (sdaForm.get('fleet').dirty || sdaForm.get('fleet').touched))" class="error">Fleet is required.</span>
            </div>

          </div>

        </div>
        <div class="col-md-6">
          <div class="row form-group">
            <h4>Defect discovered during:(Check appropriate box and describe)</h4>
            <label class="radio-inline">
              <input tabindex='14' value="0"
                     type="radio" formControlName="defectDiscoveredDuring" />
              Unscheduled Maintenance
            </label>
            <label class="radio-inline">
              <input tabindex='14'
                     value="1" type="radio"
                     formControlName="defectDiscoveredDuring" />Scheduled Maintenance
            </label>
            <div *ngIf="sdaForm.get('defectDiscoveredDuring').invalid && (showErrors || (sdaForm.get('defectDiscoveredDuring').dirty || sdaForm.get('defectDiscoveredDuring').touched))" class="error">Defect Discovered during is required.</div>
            <div *ngIf="sdaForm.get('defectDiscoveredDuring').value === '0' && sdaForm.get('unscheduledMaintenanceGroup').errors?.atleastone" class="error">Either Non-Routine # or MIC # is required.</div>
            <div *ngIf="sdaForm.get('defectDiscoveredDuring').value === '1' && sdaForm.get('scheduledMaintenanceGroup').errors?.atleastone" class="error">Either Routine # or Non-Routine # is required.</div>
          </div>
          <div formGroupName="unscheduledMaintenanceGroup" [hidden]="sdaForm.get('defectDiscoveredDuring').value !== '0'">
            <div class="row form-group">
              <label class="col-sm-4 control-label" for="unscheduledDescription">Description:<span class="req">*</span></label>
              <div class="col-sm-8">
                <input type="text" tabindex='15' class="form-control" id="unscheduledDescription"
                       placeholder="" formControlName="description">
                (RON,Pilot Report etc.)
                <div *ngIf="sdaForm.get('unscheduledMaintenanceGroup.description').invalid && (showErrors || (sdaForm.get('unscheduledMaintenanceGroup.description').dirty ||sdaForm.get('unscheduledMaintenanceGroup.description').touched))" class="error">Description is required for unscheduled maintenance.</div>

              </div>
            </div>
            <div class="row form-group">
              <label class="col-sm-4 control-label" for="unschNonRoutineNo">Non-Routine #:</label>
              <div class="col-sm-8">
                <input type="text" maxlength="50" class="form-control" tabindex='16' id="unschNonRoutineNo" placeholder=""
                       formControlName="nonRoutineNo">
                <span *ngIf="sdaForm.get('unscheduledMaintenanceGroup.nonRoutineNo').invalid && sdaForm.get('unscheduledMaintenanceGroup.nonRoutineNo').errors.pattern && (showErrors || (sdaForm.get('unscheduledMaintenanceGroup.nonRoutineNo').dirty || sdaForm.get('unscheduledMaintenanceGroup.nonRoutineNo').touched))" class="error">Non Routine # must contain only alphanumerics.</span>
              </div>
            </div>
            <div class="row form-group">
              <label class="col-sm-4 control-label" for="micNo">MIC #:</label>
              <div class="col-sm-8">
                <input type="text" maxlength="50" class="form-control" tabindex='17' id="micNo" placeholder="" formControlName="micNo">
                <span *ngIf="sdaForm.get('unscheduledMaintenanceGroup.micNo').invalid && sdaForm.get('unscheduledMaintenanceGroup.micNo').errors.pattern && (showErrors || (sdaForm.get('unscheduledMaintenanceGroup.micNo').dirty || sdaForm.get('unscheduledMaintenanceGroup.micNo').touched))" class="error">MIC # must contain only alphanumerics.</span>


              </div>
            </div>
          </div>
          <div formGroupName="scheduledMaintenanceGroup" [hidden]="sdaForm.get('defectDiscoveredDuring').value !== '1'">
            <div class="row form-group">
              <label class="col-sm-4 control-label" for="checkType">Check Type:<span class="req">*</span></label>
              <div class="col-sm-8">
                <select class="form-control" tabindex='20' id="checkType" formControlName="checkType">
                  <option value="">Select Check Type</option>
                  <!--<option *ngFor="let fc of fleetCheckTypes$ | async" [value]="fc.Name">{{fc.Name}}</option>-->
                  <option>A Check</option>
                  <option>B Check</option>
                  <option>C Check</option>
                </select>

                <!--<input type="text" #checkType="ngModel" class="form-control" name="checkType" id="checkType" [required]="alert.scheduledMaintenance"
                           [(ngModel)]="alert.checkType"
                           [typeahead]="fleetCheckTypes$"
                           [typeaheadOptionField]="'Name'"
                           [typeaheadMinLength]="0">-->
                <span *ngIf="sdaForm.get('scheduledMaintenanceGroup.checkType').invalid && (showErrors || (sdaForm.get('scheduledMaintenanceGroup.checkType').dirty || sdaForm.get('scheduledMaintenanceGroup.checkType').touched))" class="error">Check Type is required.</span>
              </div>
            </div>
            <h5>Generated By Document:</h5>

            <div class="row form-group">
              <label class="col-sm-4 control-label" for="routineNo">Routine #:</label>
              <div class="col-sm-8">
                <input type="text" maxlength="50" class="form-control" tabindex='21' id="routineNo" placeholder="" formControlName="routineNo">
                <span *ngIf="sdaForm.get('scheduledMaintenanceGroup.routineNo').invalid && sdaForm.get('scheduledMaintenanceGroup.routineNo').errors.pattern && (showErrors || (sdaForm.get('scheduledMaintenanceGroup.routineNo').dirty || sdaForm.get('scheduledMaintenanceGroup.routineNo').touched))" class="error">Routine # must contain only alphanumerics.</span>
              </div>
            </div>
            <div class="row form-group">
              <label class="col-sm-4 control-label" for="nonRoutineNo">Non-Routine #:</label>
              <div class="col-sm-8">
                <input type="text" maxlength="50" class="form-control" tabindex='22' id="nonRoutineNo" placeholder="" formControlName="nonRoutineNo" />

                <span *ngIf="sdaForm.get('scheduledMaintenanceGroup.nonRoutineNo').invalid && sdaForm.get('scheduledMaintenanceGroup.nonRoutineNo').errors.pattern && (showErrors || (sdaForm.get('scheduledMaintenanceGroup.nonRoutineNo').dirty || sdaForm.get('scheduledMaintenanceGroup.nonRoutineNo').touched))" class="error">Non Routine # must contain only alphanumerics.</span>

              </div>
            </div>
          </div>



        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="col-xs-3 pull-right">
        <button type="submit" class="btn" tabindex="20">Validate</button>
      </div>
    </div>
  </div>
</form>
<pre>{{sdaForm.errors | json}}

{{sdaForm.valid}}
{{sdaForm.get('scheduledMaintenanceGroup').errors |json}}
{{sdaForm.get('unscheduledMaintenanceGroup').errors |json}}
</pre>
